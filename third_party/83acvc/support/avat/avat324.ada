-- AVAT324.ADA

-- CHECK WHETHER TEXT FILES CAN BE CREATED.

-- NOTE: IF THE IMPLEMENTATION SUPPORTS TEXT FILES AND "XVAT324" IS
--       NOT A LEGAL FILE NAME FOR THE IMPLEMENTATION,
--       THEN THIS FILE MAY BE MODIFIED TO THE EXTENT THAT "XVAT324"
--       IS REPLACED BY A NAME WHICH IS A LEGAL FILE NAME FOR THE
--       IMPLEMENTATION.
-- PWB 08/18/87  CREATED ORIGINAL TEST.

WITH DATA_COLLECTION; USE DATA_COLLECTION;
WITH TEXT_IO; USE TEXT_IO;

PROCEDURE AVAT324 IS

     FILE : TEXT_IO.FILE_TYPE;
     FILE_NAME : CONSTANT STRING := "XVAT324";

     TESTED : THINGS_TO_SUPPORT := TEXT_FILES;
     CREATED : BOOLEAN := FALSE;

     SUPPORTED_MESSAGE : CONSTANT STRING :=
                "     TEXT FILES ARE SUPPORTED.    ";
     NOT_SUPPORTED_MESSAGE : CONSTANT STRING :=
                "     TEXT FILES ARE NOT SUPPORTED.";
     NOT_CREATED_MESSAGE : CONSTANT STRING := "          TEXT FILE " &
                                              "COULD NOT BE CREATED.";
     CREATED_MESSAGE : CONSTANT STRING := "          TEXT FILE " &
                                          "SUCCESSFULLY CREATED";
     LINE1 : STRING (1..SUPPORTED_MESSAGE'LENGTH);
     LINE2 : STRING (1..IMAGE_LENGTH'LAST);
     LINE2_LENGTH : NATURAL;

BEGIN
     CREATE_BLOCK:
     BEGIN
          CREATE (FILE, OUT_FILE, FILE_NAME);
          LINE1 := SUPPORTED_MESSAGE;
          LINE2 (1..CREATED_MESSAGE'LENGTH) := CREATED_MESSAGE;
          LINE2_LENGTH := CREATED_MESSAGE'LENGTH;
          CREATED := TRUE;
     EXCEPTION
          WHEN NAME_ERROR | USE_ERROR =>
               LINE1 := NOT_SUPPORTED_MESSAGE;
               LINE2_LENGTH := NOT_CREATED_MESSAGE'LENGTH;
               LINE2 (1..LINE2_LENGTH) := NOT_CREATED_MESSAGE;
     END CREATE_BLOCK;

     FEATURE (TESTED) := (2, ((LINE1'LENGTH, LINE1),
                              (LINE2_LENGTH, LINE2(1..LINE2_LENGTH))));
END AVAT324;
