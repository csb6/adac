-- BC3204C3M.DEP

-- OBJECTIVE:
--     CHECK THAT AN INSTANTIATION IS ILLEGAL WHEN A LIMITED/NON-LIMITED
--     FORMAL PRIVATE TYPE IS USED AS THE PARENT TYPE IN A DERIVED TYPE
--     DEFINITION APPEARING IN THE FULL DECLARATION OF A PRIVATE TYPE,
--     AND THE ACTUAL TYPE IS AN UNCONSTRAINED ARRAY TYPE OR AN
--     UNCONSTRAINED TYPE WITH DISCRIMINANTS WITHOUT DEFAULTS.
--
--     TEST WHEN THE INSTANTIATIONS ARE IN A SEPARATELY COMPILED UNIT
--     WHICH IS COMPILED BEFORE THE GENERIC BODY.

-- PASS/FAIL CRITERIA:
--     IN THIS TEST, AN ERROR MAY BE INDICATED AT LINK TIME FOR EACH
--     ILLEGAL INSTANTIATION (AS INDICATED IN THE TEST) OR BY REFUSING
--     TO ACCEPT THE GENERIC UNIT BODY FOR COMPILATION (WHEN THE
--     CORRESPONDING INSTANTIATION HAS AN ERROR INDICATION).

-- APPLICABILITY CRITERIA:
--     AN IMPLEMENTATION MAY REQUIRE THAT GENERIC UNIT BODIES BE
--     COMPILED TOGETHER WITH THEIR SPECIFICATIONS (RM 10.3/9).  AN
--     IMPLEMENTATION MAY APPLY THIS RULE TO THIS TEST, IN WHICH CASE,
--     THE TEST IS INAPPLICABLE.

-- FILES ASSOCIATED WITH THIS TEST ARE:
--   BC3204C0  - A GENERIC PACKAGE SPECIFICATION.
--   BC3204C1  - A GENERIC PACKAGE SPECIFICATION LIKE BC3204C0.
--   BC3204C2  - A GENERIC PACKAGE SPECIFICATION LIKE BC3204C0.
--   BC3204C3M - PROCEDURE BC3204C3M CONTAINING INSTANCES OF
--             - GENERIC PACKAGES C0, C1, AND C2
--   BC3204C4  - THE GENERIC PACKAGE BODY FOR C0
--   BC3204C5  - THE GENERIC PACKAGE BODY FOR C1
--   BC3204C6  - THE GENERIC PACKAGE BODY FOR C2

-- HISTORY:
--     SPS 07/12/82  CREATED ORIGINAL TEST.
--     JBG 04/29/85
--     BCB 12/28/87  MODIFIED HEADER.

--       **************************************************
-- AS A RESULT OF ADA COMMENTARY AI-00037, INSTANTIATIONS ARE ALWAYS
-- LEGAL IF THE FORMAL PARAMETER IS A PRIVATE TYPE WITHOUT DISCRIMINANTS
-- AND THE ACTUAL PARAMETER IS A TYPE WITH DEFAULT DISCRIMINANTS.
--       **************************************************

WITH BC3204C0, BC3204C1, BC3204C2;
PROCEDURE BC3204C3M IS

     TYPE UARR IS ARRAY(INTEGER RANGE <>) OF INTEGER;
     TYPE CARR IS ARRAY(INTEGER RANGE 1..10) OF INTEGER;
     TYPE REC(D : INTEGER) IS RECORD NULL; END RECORD;
     TYPE DREC(D : INTEGER := 3) IS RECORD NULL; END RECORD;
     SUBTYPE CREC IS REC(D => 3);

-- THE INSTANTIATIONS MARKED "ILLEGAL" ARE ILLEGAL BECAUSE OF THE USE OF
-- A GENERIC ACTUAL PARAMETER IN THE GENERIC UNIT BODY.

     PACKAGE N1 IS NEW BC3204C0(REC, CREC, CREC, CREC);  -- ILLEGAL: REC
     PACKAGE N2 IS NEW BC3204C1(DREC, CREC, CREC, CREC); -- OK. AI-37.
     PACKAGE N3 IS NEW BC3204C0(CREC, REC, CREC, CREC);  -- ILLEGAL: REC
     PACKAGE N4 IS NEW BC3204C1(CREC, DREC, CREC, CREC); -- OK. AI-37.
     PACKAGE N5 IS NEW BC3204C0(CREC, CREC, REC, CREC);  -- ILLEGAL: REC
     PACKAGE N6 IS NEW BC3204C1(CREC, CREC, DREC, CREC); -- OK. AI-37.
     PACKAGE N7 IS NEW BC3204C0(CREC, CREC, CREC, REC);  -- ILLEGAL: REC
     PACKAGE N8 IS NEW BC3204C1(CREC, CREC, CREC, DREC); -- OK. AI-37.
     PACKAGE N9 IS NEW BC3204C2(UARR, CARR, CARR, CARR); -- ILLEGAL: UAR
     PACKAGE N10 IS NEW BC3204C2(CARR, UARR, CARR, CARR);-- ILLEGAL: UAR
     PACKAGE N11 IS NEW BC3204C2(CARR, CARR, UARR, CARR);-- ILLEGAL: UAR
     PACKAGE N12 IS NEW BC3204C2(CARR, CARR, CARR, UARR);-- ILLEGAL: UAR
     PACKAGE N13 IS NEW BC3204C1(CREC, CREC, CREC, CREC);-- OK.
     PACKAGE N14 IS NEW BC3204C1(CARR, CARR, CARR, CARR);-- OK.
BEGIN
     NULL;
END BC3204C3M;
