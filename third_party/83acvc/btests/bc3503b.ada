-- BC3503B.ADA

-- WHEN A GENERIC FORMAL TYPE FT IS AN ACCESS TYPE AND ITS
-- DESIGNATED TYPE T IS AN ARRAY TYPE OR A TYPE WITH DISCRIMINANTS 
-- AND T IS MATCHED BY U, THE DESIGNATED TYPE OF THE ACTUAL 
-- PARAMETER, CHECK THAT U MUST BE CONSTRAINED IF AND ONLY IF T IS 
-- CONSTRAINED.

-- CHECK WHEN T IS A GENERIC FORMAL TYPE DECLARED IN THE SAME GENERIC
-- FORMAL PART AS FT.

-- SPS 5/27/82

PROCEDURE BC3503B IS

     SUBTYPE S3 IS STRING (1 .. 3);

     TYPE REC (D : CHARACTER) IS RECORD NULL; END RECORD;

     PACKAGE PRIV IS
          TYPE PV (D : INTEGER := 3) IS PRIVATE;
     PRIVATE
          TYPE PV (D : INTEGER := 3) IS
          RECORD
               CASE D IS
                    WHEN 1 .. 2 => C1 : INTEGER;
                    WHEN OTHERS => NULL;
               END CASE;
          END RECORD;
     END PRIV;

     USE PRIV;

     TYPE AS IS ACCESS STRING;
     SUBTYPE CAS IS AS (1 .. 3);
     TYPE AS3 IS ACCESS S3;
     TYPE ASC IS ACCESS STRING (1..3);

     TYPE AR IS ACCESS REC;
     SUBTYPE CAR IS AR (D => 'A');
     TYPE ARC IS ACCESS REC (D => 'A');

     TYPE APV IS ACCESS PV;
     SUBTYPE CAPV IS APV (D => 2);
     TYPE APVC IS ACCESS PV (D => 2);

     GENERIC
          TYPE T IS  PRIVATE;
          TYPE FT IS ACCESS T;
     PACKAGE P IS END P;

     GENERIC
          TYPE TP IS (<>);
          TYPE T (D :TP) IS PRIVATE;
          TYPE FT IS ACCESS T;
     PACKAGE PP IS END PP;

     PACKAGE PS1 IS NEW P (STRING, AS3);     -- ERROR: AS3 CONSTRAINED.
     PACKAGE PS2 IS NEW P (STRING, CAS);     -- ERROR: CAS CONSTRAINED.
     PACKAGE PS3 IS NEW P (STRING, ASC);     -- ERROR: ASC CONSTRAINED.
     PACKAGE PS4 IS NEW P (STRING, AS);      -- OK.

     PACKAGE PCS1 IS NEW P (S3, AS3);        -- OK.
     PACKAGE PCS2 IS NEW P (S3, CAS);        -- OK.
     PACKAGE PCS3 IS NEW P (S3, ASC);        -- OK.
     PACKAGE PCS4 IS NEW P (S3, AS);         -- ERROR: AS NOT 
                                             -- CONSTRAINED.

     PACKAGE PR2 IS NEW PP (CHARACTER, REC, CAR); -- ERROR: CAR
                                             -- CONSTRAINED.
     PACKAGE PR3 IS NEW PP (CHARACTER, REC, ARC); -- ERROR: ARC
                                             -- CONSTRAINED.
     PACKAGE PR4 IS NEW PP (CHARACTER, REC, AR);  -- OK.

     PACKAGE PP2 IS NEW PP (INTEGER, PV, APVC);  -- ERROR: PVC
                                             -- CONSTRAINED.
     PACKAGE PP3 IS NEW PP (INTEGER, PV, CAPV);  -- ERROR: PVC
                                             -- CONSTRAINED.
     PACKAGE PP4 IS NEW PP (INTEGER, PV, APV);  -- OK.

BEGIN
     NULL;
END BC3503B;
