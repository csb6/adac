-- CA5002A.ADA

-- CHECK THAT WHEN SEVERAL COMPILATION UNITS ARE SUBMITTED TO
--   A COMPILER IN A SINGLE COMPILATION, THE ORDER OF COMPILATION
--   NEED NOT BE THE SAME AS THE REQUIRED ORDER OF ELABORATION.

-- WKB 7/16/81
-- SPS 11/2/82
-- JBG 2/13/84

PACKAGE CA5002A0 IS
     ELAB_ORDER : STRING (1..3) := "   ";
     NEXT : NATURAL := 1;
END CA5002A0;


PACKAGE CA5002A1 IS
END CA5002A1;


PACKAGE CA5002A2 IS
     PROCEDURE P;
END CA5002A2;


PACKAGE CA5002A3 IS
     FUNCTION F RETURN BOOLEAN;
END CA5002A3;


WITH CA5002A0, CA5002A2;
USE CA5002A0;
PRAGMA ELABORATE (CA5002A2);
PACKAGE BODY CA5002A1 IS
BEGIN
     CA5002A2.P;
     ELAB_ORDER (NEXT) := '1';
     NEXT := NEXT + 1;
END CA5002A1;


WITH CA5002A0, CA5002A3;
USE CA5002A0;
PRAGMA ELABORATE (CA5002A3);
PACKAGE BODY CA5002A2 IS
     B : BOOLEAN := CA5002A3.F;
     PROCEDURE P IS
     BEGIN
          NULL;
     END P;
BEGIN
     ELAB_ORDER (NEXT) := '2';
     NEXT := NEXT + 1;
END CA5002A2;


WITH CA5002A0;
USE CA5002A0;
PACKAGE BODY CA5002A3 IS
     FUNCTION F RETURN BOOLEAN IS
     BEGIN
          RETURN FALSE;
     END F;
BEGIN
     ELAB_ORDER (NEXT) := '3';
     NEXT := NEXT + 1;
END CA5002A3;


WITH REPORT, CA5002A0, CA5002A1, CA5002A2, CA5002A3;
USE REPORT, CA5002A0;
PROCEDURE CA5002A IS

BEGIN
     TEST ("CA5002A", "THE ORDER OF COMPILATION OF UNITS WITHIN A " &
                      "SINGLE FILE NEED NOT BE THE SAME AS THE " &
                      "REQUIRED ELABORATION ORDER");

     IF ELAB_ORDER /= "321" THEN
          FAILED ("INCORRECT ELABORATION ORDER");
     END IF;

     RESULT;
END CA5002A;
