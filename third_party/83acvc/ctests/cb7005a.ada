-- CB7005A.ADA

-- OBJECTIVE:
--     CHECK THAT FOR A SUPPRESS PRAGMA WITH A FIRST ARGUMENT OF
--     ELABORATION_CHECK, THE SECOND ARGUMENT MUST BE THE NAME OF A
--     TASK UNIT, GENERIC UNIT OR SUBPROGRAM. (ELSE THE PRAGMA IS
--     IGNORED).

-- HISTORY:
--     DHH 04/01/88 CREATED ORIGINAL TEST.

WITH REPORT; USE REPORT;
PROCEDURE CB7005A IS

BEGIN
     TEST("CB7005A", "CHECK THAT FOR A SUPPRESS PRAGMA WITH A FIRST " &
                     "ARGUMENT OF ELABORATION_CHECK, THE SECOND " &
                     "ARGUMENT MUST BE THE NAME OF A TASK UNIT, " &
                     "GENERIC UNIT OR SUBPROGRAM. (ELSE THE PRAGMA " &
                     "IS IGNORED)");
     DECLARE

          PACKAGE PACK IS
               FUNCTION PACK RETURN INTEGER;
          END PACK;

          PRAGMA SUPPRESS(ELABORATION_CHECK, PACK);
          X : INTEGER := PACK.PACK;

          PACKAGE BODY PACK IS
               FUNCTION PACK RETURN INTEGER IS
               BEGIN
                    IF EQUAL(3,3) THEN
                         RETURN 5;
                    ELSE
                         RETURN 3;
                    END IF;
               END PACK;

          BEGIN      -- BODY PACKAGE PACK
               FAILED("EXCEPTION NOT RAISED ON ELABORATION_CHECK");
          END PACK;  -- BODY PACKAGE PACK

     BEGIN           -- DECLARE
          IF EQUAL(X,X) THEN
               FAILED("EXCEPTION NOT RAISED ON ELABORATION_CHECK - A");
          ELSE
               FAILED("EXCEPTION NOT RAISED ON ELABORATION_CHECK - B");
          END IF;

     END;            -- DECLARE

     RESULT;

EXCEPTION
     WHEN PROGRAM_ERROR =>
          NULL;
          RESULT;
     WHEN OTHERS =>
          FAILED("UNEXPECTED EXCEPTION RAISED ON " &
                 "ELABORATION_CHECK");
          RESULT;
END CB7005A;
