-- C38201A.ADA

-- CHECK THAT ARRAY ATTRIBUTES ARE DECLARED AND RETURN CORRECT 
-- VALUES FOR OBJECTS HAVING AN ACCESS TYPE WHOSE DESIGNATED 
-- TYPE IS AN ARRAY TYPE AND FOR FUNCTION CALL RESULTS HAVING
-- AN ACCESS TYPE WHOSE DESIGNATED TYPE IS AN ARRAY TYPE.

-- AH  9/10/86

WITH REPORT; USE REPORT;
PROCEDURE C38201A IS

     TYPE ENUM IS (MONDAY, TUESDAY, WEDNESDAY, THURSDAY, FRIDAY);
     TYPE ARR1 IS ARRAY (INTEGER RANGE <>) OF INTEGER;
     TYPE ARR2 IS ARRAY (INTEGER RANGE <>, INTEGER RANGE <>) OF INTEGER;
     TYPE ARR3 IS ARRAY (BOOLEAN) OF INTEGER;
     TYPE ARR4 IS ARRAY (BOOLEAN, BOOLEAN) OF INTEGER;
     TYPE ARR5 IS ARRAY (ENUM) OF INTEGER;
     TYPE ARR6 IS ARRAY (ENUM RANGE TUESDAY .. THURSDAY) OF INTEGER;
     TYPE ARR7 IS ARRAY (0 .. 3) OF INTEGER;
     TYPE ARR8 IS ARRAY (7 .. 8, 1 .. 2) OF INTEGER;

     TYPE ACC1 IS ACCESS ARR1(1 .. 10);
     TYPE ACC2 IS ACCESS ARR2(1 .. 5, 6 .. 10);
     TYPE ACC3 IS ACCESS ARR3;
     TYPE ACC4 IS ACCESS ARR4;
     TYPE ACC5 IS ACCESS ARR5;
     TYPE ACC6 IS ACCESS ARR6;
     TYPE ACC7 IS ACCESS ARR7;
     TYPE ACC8 IS ACCESS ARR8;

     OBJ1 : ACC1 := NEW ARR1(1 .. 10);
     OBJ2 : ACC2 := NEW ARR2(1 .. 5, 6 .. 10);
     OBJ3 : ACC3 := NEW ARR3;
     OBJ4 : ACC4 := NEW ARR4;
     OBJ5 : ACC5 := NEW ARR5;
     OBJ6 : ACC6 := NEW ARR6;
     OBJ7 : ACC7 := NEW ARR7;
     OBJ8 : ACC8 := NEW ARR8;

     FUNCTION F1 RETURN ACC1 IS 
     BEGIN
          RETURN NEW ARR1(1 .. 10);
     END F1;

     FUNCTION F8 RETURN ACC8 IS
     BEGIN
          RETURN NEW ARR8;
     END F8;

     FUNCTION F5 RETURN ACC5 IS
     BEGIN
          RETURN NEW ARR5;
     END F5;

BEGIN
     TEST ("C38201A", "OBJECTS AND FUNCTION RESULTS HAVING " &
           "ACCESS TYPES WITH ARRAY " &
           "DESIGNATED TYPE CAN HAVE ARRAY ATTRIBUTES");

     IF (OBJ1'FIRST /= 1) OR (OBJ1'LAST /= 10) OR
        (OBJ1'LENGTH /= 10) OR (3 NOT IN OBJ1'RANGE) THEN
          FAILED ("OBJ1 HAS INCORRECT ATTRIBUTE VALUES");
     END IF;

     IF (OBJ2'FIRST(1) /= 1) OR (OBJ2'FIRST(2) /= 6) OR
        (OBJ2'LAST(1) /= 5) OR (OBJ2'LAST(2) /= 10) OR
        (OBJ2'LENGTH(1) /= 5) OR (OBJ2'LENGTH(2) /= 5) OR
        (3 NOT IN OBJ2'RANGE(1)) OR (9 NOT IN OBJ2'RANGE(2)) THEN
          FAILED ("OBJ2 HAS INCORRECT ATTRIBUTE VALUES");
     END IF;

     IF (OBJ3'FIRST /= FALSE) OR (OBJ3'LAST /= TRUE) OR
        (OBJ3'LENGTH /= 2) OR (TRUE NOT IN OBJ3'RANGE) THEN
          FAILED ("OBJ3 HAS INCORRECT ATTRIBUTE VALUES");
     END IF;

     IF (OBJ4'FIRST(1) /= FALSE) OR (OBJ4'FIRST(2) /= FALSE) OR
        (OBJ4'LAST(1) /= TRUE) OR (OBJ4'LAST(2) /= TRUE) OR
        (OBJ4'LENGTH(1) /= 2) OR (OBJ4'LENGTH(2) /= 2) OR
        (FALSE NOT IN OBJ4'RANGE(1)) OR (TRUE NOT IN OBJ4'RANGE(2)) THEN
          FAILED ("OBJ4 HAS INCORRECT ATTRIBUTE VALUES");
     END IF;

     IF (OBJ5'FIRST /= MONDAY) OR (OBJ5'LAST /= FRIDAY) OR
        (OBJ5'LENGTH /= 5) OR (WEDNESDAY NOT IN OBJ5'RANGE) THEN
          FAILED ("OBJ5 HAS INCORRECT ATTRIBUTE VALUES");
     END IF;

     IF (OBJ6'FIRST /= TUESDAY) OR (OBJ6'LAST /= THURSDAY) OR
        (OBJ6'LENGTH /= 3) OR (THURSDAY NOT IN OBJ6'RANGE) THEN
          FAILED ("OBJ6 HAS INCORRECT ATTRIBUTE VALUES");
     END IF;

     IF (OBJ7'FIRST /= 0) OR (OBJ7'LAST /= 3) OR
        (OBJ7'LENGTH /= 4) OR (2 NOT IN OBJ7'RANGE) THEN
          FAILED ("OBJ7 HAS INCORRECT ATTRIBUTE VALUES");
     END IF;

     IF (OBJ8'FIRST(1) /= 7) OR (OBJ8'FIRST(2) /= 1) OR
        (OBJ8'LAST(1) /= 8) OR (OBJ8'LAST(2) /= 2) OR
        (OBJ8'LENGTH(1) /= 2) OR (OBJ8'LENGTH(2) /= 2) OR
        (7 NOT IN OBJ8'RANGE(1)) OR (1 NOT IN OBJ8'RANGE(2)) THEN
          FAILED ("OBJ8 HAS INCORRECT ATTRIBUTE VALUES");
     END IF;

     IF (F1'FIRST /= 1) OR (F1'LAST /= 10) OR
        (F1'LENGTH /= 10) OR (3 NOT IN F1'RANGE) THEN
          FAILED ("FUNCTION CALL F1 HAS INCORRECT ATTRIBUTE VALUES");
     END IF;

     IF (F8'FIRST(1) /= 7) OR (F8'FIRST(2) /= 1) OR
        (F8'LAST(1) /= 8) OR (F8'LAST(2) /= 2) OR
        (F8'LENGTH(1) /= 2) OR (F8'LENGTH(2) /= 2) OR
        (7 NOT IN F8'RANGE(1)) OR (1 NOT IN F8'RANGE(2)) THEN
          FAILED ("FUNCTION CALL F8 HAS INCORRECT ATTRIBUTE VALUES");
     END IF;

     IF (F5'FIRST /= MONDAY) OR (F5'LAST /= FRIDAY) OR
        (F5'LENGTH /= 5) OR (WEDNESDAY NOT IN F5'RANGE) THEN
          FAILED ("FUNCTION CALL F5 HAS INCORRECT ATTRIBUTE VALUES");
     END IF;

     RESULT;
END C38201A;
