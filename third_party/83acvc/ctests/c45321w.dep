-- C45321W.DEP

-- OBJECTIVE:
--     TESTS ON ADDING OPERATORS AS 12 SUBTESTS.
--       (A) THE OPERATOR +, A, B, AND A+B ALL MODEL NUMBERS.
--       (B) THE OPERATOR +, A, B MODEL NUMBERS A+B NOT.
--       (C) THE OPERATOR +, A MODEL NUMBER, B, A+B NOT.
--       (D) THE OPERATOR +, A, B, AND A+B ALL MODEL NUMBERS OF
--           DIFFERENT SUBTYPES.
--       (E) THE OPERATOR +, A, B MODEL NUMBERS A+B NOT, WITH
--           DIFFERENT SUBTYPES.
--       (F) THE OPERATOR +, A MODEL NUMBER, B, A+B NOT, WITH
--           DIFFERENT SUBTYPES.
--       (G) THE OPERATOR -, A, B, AND A-B ALL MODEL NUMBERS.
--       (H) THE OPERATOR -, A, B MODEL NUMBERS A-B NOT.
--       (I) THE OPERATOR -, A MODEL NUMBER, B, A-B NOT.
--       (J) THE OPERATOR -, A, B, AND A-B ALL MODEL NUMBERS OF
--           DIFFERENT SUBTYPES.
--       (K) THE OPERATOR -, A, B MODEL NUMBERS A-B NOT, WITH
--           DIFFERENT SUBTYPES.
--       (L) THE OPERATOR -, A MODEL NUMBER, B, A-B NOT, WITH
--           DIFFERENT SUBTYPES.
--      THIS TEST IS TO BE REPEATED FOR 'DIGITS = 5 .. 29.

-- APPLICABILITY CRITERIA:
--     THIS TEST IS APPLICABLE ONLY TO IMPLEMENTATIONS WHICH SUPPORT A
--     VALUE OF DIGITS GREATER THAN OR EQUAL TO 27.

--     IF 'DIGITS 27' IS NOT SUPPORTED, THEN THE DECLARATION OF 'TYPE F'
--     MUST BE REJECTED.

-- HISTORY:
--     BAW 09/17/80
--     JBG 11/10/82
--     JBG 07/29/84
--     JBG 10/12/86 ADD CODE TO ENSURE RUN-TIME ADDING OPERATORS ARE
--              USED BY OPTIMIZING COMPILERS; REMOVE -B FROM TEST NAME.
--     DHH 01/11/88 ADDED APPLICABILITY CRITERIA AND STANDARD HEADER.

WITH REPORT;
PROCEDURE C45321W IS

     USE REPORT;

     N : CONSTANT INTEGER := 27;      -- NUMBER OF DIGITS
     TYPE F IS DIGITS N;             -- MANTISSA BITS: 91  N/A => ERROR.
     SUBTYPE F1 IS F DIGITS N-1;     -- MANTISSA BITS: 88
     SUBTYPE F2 IS F DIGITS N-2;     -- MANTISSA BITS: 85
BEGIN TEST ("C45321W", "CHECK FLOATING POINT ADDING OPERATORS");
      DECLARE  --(A)
              A : F := 16#0.A0000000000000000005E68#E10;
              B : F := 16#0.4000000000000000000033A#E10;
              C : F := 0.0;
              D : F := A + B;

      BEGIN COMMENT("(A) CHECK +, A, B, A+B ALL MODEL NUMBERS " &
                    "FOR FLOATING POINT");

            IF NOT EQUAL(3,3) THEN      -- NEVER TRUE
                 A := 0.0;
            END IF;

            IF EQUAL(2,2) THEN
                 C := A + B;
            END IF;

            IF C /= 16#0.E00000000000000000061A2#E10
            OR D /= 16#0.E00000000000000000061A2#E10
            THEN
                 FAILED("THE RESULT OF THE ADDITION IS INCORRECT");
            END IF;

      END;  --(A)

      DECLARE  --(B)
              A : F := 16#0.A0000000000000000000664#E10;
              B : F := 16#0.A0000000000000000000004#E9;
              C : F := 0.0;
              D : F := A + B;

      BEGIN COMMENT("(B) CHECK +, A, B MODEL NUMBERS " &
                 " A+B NOT (FOR FLOATING POINT)");

            IF NOT EQUAL(3,3) THEN      -- NEVER EXECUTED.
                 A := 0.0;
            END IF;

            IF EQUAL(2,2) THEN
                 C := A + B;
            END IF;

            IF (C < 16#0.AA000000000000000000664#E10)
            OR (C > 16#0.AA000000000000000000666#E10)
            OR (D < 16#0.AA000000000000000000664#E10)
            OR (D > 16#0.AA000000000000000000666#E10)
            THEN
                 FAILED("THE RESULT OF THE ADDITION IS INCORRECT");
            END IF;

      END;  --(B)

      DECLARE  --(C)
              A : F := 16#0.A0000000000000000000668#;
              B : F := 16#0.A000000000000000000066F#;
              C : F := 0.0;
              D : F := A + B;

      BEGIN COMMENT("(C) CHECK +, A MODEL NUMBER B, A+B NOT "&
                 " (FOR FLOATING POINT)");

            IF NOT EQUAL(3,3) THEN      -- NEVER EXECUTED.
                 A := 0.0;
            END IF;

            IF EQUAL(2,2) THEN
                 C := A + B;
            END IF;

            IF (C < 16#1.40000000000000000000CD4#)
            OR (C > 16#1.40000000000000000000CD8#)
            OR (D < 16#1.40000000000000000000CD4#)
            OR (D > 16#1.40000000000000000000CD8#)
            THEN
                 FAILED("THE RESULT OF THE ADDITION IS INCORRECT");
            END IF;

      END;  --(C)

      DECLARE  --(D)

              A : F1 := 16#0.A000000000000000000006#;
              B : F2 := 16#0.A000000000000000000018#;
              C : F1 := 0.0;
              D : F1 := A + B;

      BEGIN COMMENT("(D) CHECK +, A, B, A+B ALL MODEL NUMBERS " &
                 " (FOR FLOATING POINT) WITH DIFFERENT SUBTYPES");

            IF NOT EQUAL(3,3) THEN      -- NEVER EXECUTED.
                 A := 0.0;
            END IF;

            IF EQUAL(2,2) THEN
                 C := A + B;
            END IF;

            IF C /= 16#1.400000000000000000001E#
            OR D /= 16#1.400000000000000000001E#
            THEN
                 FAILED("THE RESULT OF THE ADDITION IS INCORRECT");
            END IF;

      END;  --(D)

      DECLARE  --(E)

              A : F1 := 16#0.A000000000000000000007#;
              B : F2 := 16#0.A00000000000000000003#;
              C : F1 := 0.0;
              D : F1 := A + B;

      BEGIN COMMENT("(E) CHECK +, A, B MODEL NUMBERS, A+B NOT " &
                 " (FOR FLOATING POINT) WITH DIFFERENT SUBTYPES");

            IF NOT EQUAL(3,3) THEN      -- NEVER EXECUTED.
                 A := 0.0;
            END IF;

            IF EQUAL(2,2) THEN
                 C := A + B;
            END IF;

            IF (C < 16#1.4000000000000000000001B#)
            OR (C > 16#1.4000000000000000000038#)
            OR (D < 16#1.4000000000000000000001B#)
            OR (D > 16#1.4000000000000000000038#)
            THEN
                 FAILED("THE RESULT OF THE ADDITION IS INCORRECT");
            END IF;

      END;  --(E)

      DECLARE  --(F)
              A : F1 := 16#0.A000000000000000000007#;
              B : F2 := 16#0.A0000000000000000000334#;
              C : F1 := 0.0;
              D : F1 := A + B;

      BEGIN COMMENT("(F) CHECK +, A MODEL NUMBER, B, A+B NOT " &
                 " (FOR FLOATING POINT) WITH DIFFERENT SUBTYPES");

            IF NOT EQUAL(3,3) THEN      -- NEVER EXECUTED.
                 A := 0.0;
            END IF;

            IF EQUAL(2,2) THEN
                 C := A + B;
            END IF;

            IF (C < 16#1.4000000000000000000036#)
            OR (C > 16#1.400000000000000000004#)
            OR (D < 16#1.4000000000000000000036#)
            OR (C > 16#1.400000000000000000004#)
            THEN
                 FAILED("THE RESULT OF THE ADDITION IS INCORRECT");
            END IF;

      END;  --(F)

      DECLARE  --(G)
              A : F := 16#0.F00000000000000000009A4#E10;
              B : F := 16#0.4000000000000000000033A#E10;
              C : F := 0.0;
              D : F := A - B;

      BEGIN COMMENT("(G) CHECK -, A, B, A-B ALL MODEL NUMBERS " &
                 " FOR FLOATING POINT");

            IF NOT EQUAL(3,3) THEN      -- NEVER EXECUTED.
                 A := 0.0;
            END IF;

            IF EQUAL(2,2) THEN
                 C := A - B;
            END IF;

            IF C /= 16#0.B000000000000000000066A#E10
            OR D /= 16#0.B000000000000000000066A#E10
            THEN
                 FAILED("THE RESULT OF THE SUBTRACTION IS INCORRECT");
            END IF;

      END;  --(G)

      DECLARE  --(H)
              A : F := 16#0.A0000000000000000005E6E#;
              B : F := 16#0.300000000000000000011A28#;
              C : F := 0.0;
              D : F := A - B;

      BEGIN COMMENT("(H) CHECK -, A, B, MODEL NUMBERS, A-B NOT " &
                 " (FOR FLOATING POINT)");

            IF NOT EQUAL(3,3) THEN      -- NEVER EXECUTED.
                 A := 0.0;
            END IF;

            IF EQUAL(2,2) THEN
                 C := A - B;
            END IF;

            IF (C < 16#0.70000000000000000004CC3#)
            OR (C > 16#0.70000000000000000004CCC4#)
            OR (D < 16#0.70000000000000000004CC3#)
            OR (D > 16#0.70000000000000000004CCC4#)
            THEN
                 FAILED("THE RESULT OF THE SUBTRACTION IS INCORRECT");
            END IF;

     END;  --(H)

      DECLARE  --(I)
              A : F := 16#0.A0000000000000000005E6E#;
              B : F := 16#0.400000000000000000022B38#;
              C : F := 0.0;
              D : F := A - B;

      BEGIN COMMENT("(I) CHECK -, A MODEL NUMBER, B, A-B NOT " &
                 " (FOR FLOATING POINT)");

            IF NOT EQUAL(3,3) THEN      -- NEVER EXECUTED.
                 A := 0.0;
            END IF;

            IF EQUAL(2,2) THEN
                 C := A - B;
            END IF;

            IF (C < 16#0.60000000000000000003BBA#)
            OR (C > 16#0.60000000000000000003BBB#)
            OR (D < 16#0.60000000000000000003BBA#)
            OR (D > 16#0.60000000000000000003BBB#)
            THEN
                 FAILED("THE RESULT OF THE SUBTRACTION IS INCORRECT");
            END IF;

      END;  --(I)

      DECLARE  --(J)
              A : F1 := 16#0.C00000000000000000000F#;
              B : F2 := 16#0.2000000000000000000002#;
              C : F1 := 0.0;
              D : F1 := A - B;

      BEGIN COMMENT("(J) CHECK -, A, B, A-B ALL MODEL NUMBERS " &
                 " (FOR FLOATING POINT) WITH DIFFERENT SUBTYPES");

            IF NOT EQUAL(3,3) THEN      -- NEVER EXECUTED.
                 A := 0.0;
            END IF;

            IF EQUAL(2,2) THEN
                 C := A - B;
            END IF;

            IF C /= 16#0.A00000000000000000000D#
            OR D /= 16#0.A00000000000000000000D#
            THEN
                 FAILED("THE RESULT OF THE SUBTRACTION IS INCORRECT");
            END IF;

      END;  --(J)

      DECLARE  --(K)
              A : F1 := 16#A.B0000000000000000007F#;
              B : F2 := 16#0.700000000000000000002C#;
              C : F1 := 0.0;
              D : F1 := A - B;

      BEGIN COMMENT("(K) CHECK -, A, B MODEL NUMBERS, A-B NOT " &
                 " (FOR FLOATING POINT) WITH DIFFERENT SUBTYPES");

            IF NOT EQUAL(3,3) THEN      -- NEVER EXECUTED.
                 A := 0.0;
            END IF;

            IF EQUAL(2,2) THEN
                 C := A - B;
            END IF;

            IF (C < 16#A.40000000000000000007C#)
            OR (C > 16#A.40000000000000000007D#)
            OR (D < 16#A.40000000000000000007C#)
            OR (C > 16#A.40000000000000000007D#)
            THEN
                 FAILED("THE RESULT OF THE SUBTRACTION IS INCORRECT");
            END IF;

      END;  --(K)

      DECLARE  --(L)
              A : F1 := 16#0.A000000000000000000007#;
              B : F2 := -16#0.A0000000000000000000334#;
              C : F1 := 0.0;
              D : F1 := A - B;

      BEGIN COMMENT("(L) CHECK -, A MODEL NUMBER, B, A-B NOT " &
                 " (FOR FLOATING POINT) WITH DIFFERENT SUBTYPES");

            IF NOT EQUAL(3,3) THEN      -- NEVER EXECUTED.
                 A := 0.0;
            END IF;

            IF EQUAL(2,2) THEN
                 C := A - B;
            END IF;

            IF (C < 16#1.4000000000000000000036#)
            OR (C > 16#1.400000000000000000004#)
            OR (D < 16#1.4000000000000000000036#)
            OR (C > 16#1.400000000000000000004#)
            THEN
                 FAILED("THE RESULT OF THE SUBTRACTION IS INCORRECT");
            END IF;

      END;  --(L)

      RESULT;

END C45321W;
