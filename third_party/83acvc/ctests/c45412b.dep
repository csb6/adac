-- C45412B.DEP

-- OBJECTIVE:
--     CHECK THAT NUMERIC_ERROR OR CONSTRAINT_ERROR IS RAISED BY
--     UNARY "-" IF THE RANGE OF SHORT_INTEGER INDICATES A NONSYMMETRIC
--     RANGE OF VALUES.

-- APPLICABILITY CRITERIA:
--     THIS TEST IS APPLICABLE ONLY TO IMPLEMENTATIONS THAT SUPPORT
--     THE PREDEFINED SHORT_INTEGER TYPE.

--     IF THE TYPE SHORT_INTEGER IS NOT SUPPORTED, THEN THE
--     DECLARATION OF "A" MUST BE REJECTED.

-- HISTORY:
--     JET 07/11/88  CREATED ORIGINAL TEST.

WITH REPORT; USE REPORT;

PROCEDURE C45412B IS

     A : SHORT_INTEGER;                              -- N/A => ERROR.

     FUNCTION IDENT (X : SHORT_INTEGER) RETURN SHORT_INTEGER IS
     BEGIN
          RETURN X * SHORT_INTEGER(IDENT_INT(1));
     END IDENT;

     FUNCTION EQUAL (X,Y : SHORT_INTEGER) RETURN BOOLEAN IS
     BEGIN
          RETURN X = IDENT(Y);
     END EQUAL;

BEGIN
     TEST ("C45412B", "CHECK THAT NUMERIC_ERROR OR CONSTRAINT_ERROR " &
                      "IS RAISED BY UNARY ""-"" IF THE RANGE OF " &
                      "SHORT_INTEGER INDICATES A NONSYMMETRIC RANGE " &
                      "OF VALUES");

     IF SHORT_INTEGER'FIRST + SHORT_INTEGER'LAST /= IDENT(0) THEN
          BEGIN
               A := -SHORT_INTEGER'FIRST;

               FAILED ("NO EXCEPTION RAISED BY UNARY ""-"" " &
                       "ON SHORT_INTEGER'FIRST");

               IF NOT EQUAL (A,A) THEN
                    COMMENT ("DON'T OPTIMIZE 'A'");
               END IF;
          EXCEPTION
               WHEN NUMERIC_ERROR | CONSTRAINT_ERROR =>
                    NULL;
               WHEN OTHERS =>
                    FAILED ("WRONG EXCEPTION RAISED BY UNARY ""-"" " &
                            "ON SHORT_INTEGER'FIRST");
          END;
     ELSE
          COMMENT ("PREDEFINED SHORT_INTEGER BASE TYPE IS SYMMETRIC");
     END IF;

     RESULT;

END C45412B;
