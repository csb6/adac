-- C45532J.DEP

-- OBJECTIVE:
--     CHECK THAT THE OPERATOR "/" PRODUCES CORRECT RESULTS
--     FOR FIXED POINT TYPES USING 3 SUBTESTS.
--       THIS TEST REQUIRES MIN_WORD_LENGTH = 32.
--       THIS TEST USES VALUES OF DELTA WHICH ARE LESS THAN 0.5.
--
--     TEST CASES ARE:
--       A) THE OPERATOR /, A, B, AND A / B ALL MODEL NUMBERS.
--       B) THE OPERATOR /, A, B MODEL NUMBERS A / B NOT.
--       C) THE OPERATOR /, USING NO MODEL NUMBERS.
--
--     REPEAT FOR MINIMUM REQUIRED WORD LENGTHS OF 12, 16, 32 AND 48,
--     WITH RANGE <, =, AND > THAN 1.0 AND
--     WITH DELTA <, =, AND > THAN 1.0.

-- APPLICABILITY CRITERIA:
--     THIS TEST IS APPLICABLE ONLY TO IMPLEMENTATIONS WHICH SUPPORT
--     ALL OF THE DECLARED FIXED POINT TYPES.

--     IF ONE OR MORE OF THESE TYPES ARE NOT SUPPORTED, THEN THE
--     CORESPONDING TYPE DECLARATIONS MUST BE REJECTED.

-- HISTORY:
--     NTW 09/08/86 CREATED ORIGINAL TEST.
--     RJW 11/05/86 REVISED COMMENTS.
--     DHH 10/19/87 SHORTENED LINES CONTAINING MORE THAN 72 CHARACTERS.

WITH REPORT;
PROCEDURE C45532J IS

     USE REPORT;

     MIN_WORD_LENGTH : CONSTANT := 32;            -- MUST BE EVEN & >= 6
     FULL_SCALE      : CONSTANT := 2 ** (MIN_WORD_LENGTH - 1);
     FORTH           : CONSTANT := FULL_SCALE / 4;
     A_THIRD         : CONSTANT := FULL_SCALE / 3;
     DEL1            : CONSTANT := 0.5 / FULL_SCALE;
     TYPE FX_0P5 IS DELTA DEL1 * 1 RANGE -0.5 ..
                                      0.5 - DEL1 * 1; -- N/A => ERROR.
     TYPE FX_1   IS DELTA DEL1 * 2 RANGE -1.0 ..
                                      1.0 - DEL1 * 2; -- N/A => ERROR.
     TYPE FX_2   IS DELTA DEL1 * 4 RANGE -2.0 ..
                                      2.0 - DEL1 * 4; -- N/A => ERROR.

BEGIN TEST ("C45532J", "FIXED POINT OPERATOR ""/""" );

     --------------------------------------------------

     -- CASE A) THE OPERATOR /, A, B, AND A / B ALL MODEL NUMBERS.

A:   DECLARE
          A              : FX_0P5  := 0.0;
          B              : FX_1    := 0.0;
          RESULT_VALUE   : FX_2    := 0.0;
          LOWEST_ACCEPTABLE_VALUE  : FX_2 := FX_2 (0.5);
          HIGHEST_ACCEPTABLE_VALUE : FX_2 := FX_2 (0.5);
     BEGIN
          IF EQUAL (3, 3) THEN
               A := FX_0P5 (0.125);               -- A MODEL NUMBER
               B := FX_1   (0.25);                -- A MODEL NUMBER
          END IF;

          RESULT_VALUE := FX_2 (A / B);

          IF    (RESULT_VALUE < LOWEST_ACCEPTABLE_VALUE)
             OR (RESULT_VALUE > HIGHEST_ACCEPTABLE_VALUE) THEN
               FAILED ("RESULT OF ""/"" OUTSIDE RESULT MODEL INTERVAL "
                    &  "WHEN A, B, AND A / B ARE ALL MODEL NUMBERS");
          END IF;
     END A;

     --------------------------------------------------

     -- CASE B) THE OPERATOR /, A, B MODEL NUMBERS A / B NOT.

B:   DECLARE
          A              : FX_0P5  := 0.0;
          B              : FX_0P5  := 0.0;
          RESULT_VALUE   : FX_1    := 0.0;
          LOWEST_ACCEPTABLE_VALUE  :  FX_1
                                   := FX_1 (2 * DEL1 * A_THIRD);
          HIGHEST_ACCEPTABLE_VALUE :  FX_1
                                   := FX_1 (2 * DEL1 * (A_THIRD + 1) );
     BEGIN
          IF EQUAL (3, 3) THEN
               A := FX_0P5 (DEL1 * 1);            -- A MODEL NUMBER
               B := FX_0P5 (DEL1 * 3);            -- A MODEL NUMBER
          END IF;

          RESULT_VALUE := FX_1 (A / B);

          IF    (RESULT_VALUE < LOWEST_ACCEPTABLE_VALUE)
             OR (RESULT_VALUE > HIGHEST_ACCEPTABLE_VALUE) THEN
               FAILED ("RESULT OF ""/"" OUTSIDE RESULT MODEL INTERVAL "
                    &  "WHEN A, B MODEL NUMBERS A / B NOT");
          END IF;
     END B;

     --------------------------------------------------

     -- CASE C) THE OPERATOR /, USING NO MODEL NUMBERS

C:   DECLARE
          A              : FX_1    := 0.0;
          B              : FX_1    := 0.0;
          RESULT_VALUE   : FX_0P5  := 0.0;
          LOW_COUNT    : CONSTANT  := 2 * A_THIRD;
                            --   := (2 * FULL_SCALE * (2 * FORTH + 0))
                            --                      / (6 * FORTH + 2);
          HIGH_COUNT   : CONSTANT  := 2 * A_THIRD + 4;
                            --   := (2 * FULL_SCALE * (2 * FORTH + 2))
                            --                      / (6 * FORTH + 0);
          LOWEST_ACCEPTABLE_VALUE  :  FX_0P5
                                   := FX_0P5 (DEL1 * LOW_COUNT );
          HIGHEST_ACCEPTABLE_VALUE :  FX_0P5
                                   := FX_0P5 (DEL1 * HIGH_COUNT );
     BEGIN
          IF EQUAL (3, 3) THEN     -- A AND B NOT MODEL NUMBERS
               A := FX_1 (DEL1 * (2 * FORTH + 1));
               B := FX_1 (DEL1 * (6 * FORTH + 1));
          END IF;

          RESULT_VALUE := FX_0P5 (A / B);

          IF    (RESULT_VALUE < LOWEST_ACCEPTABLE_VALUE)
             OR (RESULT_VALUE > HIGHEST_ACCEPTABLE_VALUE) THEN
               FAILED ("RESULT OF ""/"" OUTSIDE RESULT MODEL INTERVAL "
                    &  "WHEN USING NO MODEL NUMBERS");
          END IF;
     END C;

     --------------------------------------------------


     RESULT;

END C45532J;
