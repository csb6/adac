-- C45241O.DEP

-- OBJECTIVE:
--     TESTS ON RELATIONAL OPERATORS AS SIX SUBTESTS:

--       (A) CHECK A /= B SAME AS NOT(A=B).
--       (B) CHECK A < B SAME AS NOT(A>=B).
--       (C) CHECK A > B SAME AS NOT(A<>B).
--       (D) ADJACENT MODEL NUMBER GIVE CORRECT RESULT.
--       (E) NON-MODEL NUMBERS WITH DISTINCT MODEL INTERVALS
--           GIVE CORRECT RESULT.
--       (F) CASE WHERE MODEL INTERVALS INTERSECT IN SINGLE
--           MODEL NUMBER GIVES CORRECT RESULT.
--    THIS TEST IS REPEATED FOR DIGITS = 5 .. 29.

-- APPLICABILITY CRITERIA:
--     THIS TEST IS APPLICABLE ONLY TO IMPLEMENTATIONS WHICH SUPPORT A
--     VALUE OF DIGITS GREATER THAN OR EQUAL TO 19.

--     IF 'DIGITS 19' IS NOT SUPPORTED, THEN THE DECLARATION OF 'TYPE F'
--     MUST BE REJECTED.

-- HISTORY:
--     BAW 09/17/80 CREATED ORIGINAL TEST.
--     JBG 11/10/82
--     JBG 10/12/86 ADD CODE TO ALLOW COMPILE-TIME CHECK (FOR OPTIMIZING
--                  COMPILERS); REMOVE -B FROM TEST NAME.
--     DHH 01/11/88 ADDED APPLICABILITY CRITERIA AND STANDARD HEADER.

WITH REPORT;
PROCEDURE C45241O IS

     USE REPORT;

     TYPE F IS DIGITS 19;                             -- N/A => ERROR.
     A : F := 0.0;
     B : F := 0.0;


BEGIN
      TEST("C45241O", "CHECK FLOATING RELATIONAL OPERATORS");
      BEGIN
            COMMENT("CHECK IF A /= B IS THE SAME AS NOT(A = B) " &
                 "FOR FLOATING POINT");

            IF EQUAL (2,2) THEN
                 A :=   -- JUST BELOW A MODEL NUMBER;
                      16#0.A00000000000179B6#;
                 B :=   -- JUST ABOVE A MODEL NUMBER;
                      16#0.A00000000000179BA#;

                 IF (A /= B) /= (NOT (A = B)) THEN
                      FAILED("A /= B NOT THE SAME AS NOT(A = B) - CT");
                 END IF;

                 IF (A < B) /= (NOT (A >= B)) THEN
                      FAILED("A < B NOT THE SAME AS NOT(A >= B) - CT");
                 END IF;

                 IF (A > B) /= (NOT (A <= B)) THEN
                      FAILED("A > B NOT THE SAME AS NOT(A <= B) - CT");
                 END IF;

            END IF;

            IF (A /= B) /= (NOT (A = B)) THEN
                 FAILED("A /= B IS NOT THE SAME AS NOT(A = B)");
            END IF;

      END;  --(A)

      BEGIN COMMENT("CHECK IF A < B IS THE SAME AS NOT(A >= B) " &
                 "FOR FLOATING POINT");

            IF (A < B) /= (NOT (A >= B)) THEN
                 FAILED("A < B IS NOT THE SAME AS NOT(A >= B) ");
            END IF;

      END;  --(B)

      BEGIN COMMENT("CHECK IF A > B IS THE SAME AS NOT(A <= B) " &
                 "FOR FLOATING POINT ");

            IF (A > B) /= (NOT (A <= B)) THEN
                 FAILED("A > B IS NOT THE SAME AS NOT(A <= B) ");
            END IF;

      END;  --(C)

      DECLARE
              A : F := 0.0;
              B : F := 0.0;

      BEGIN COMMENT("CHECK ADJACENT MODEL NUMBERS GIVE CORRECT " &
                 "RESULT IN COMPARISONS FOR FLOATING POINT");

            IF EQUAL (2,2) THEN
                 A := 16#0.A0000000000017988#;
                 B := 16#0.A000000000001799#;

                 IF NOT (B > A) THEN
                      FAILED("INCORRECT COMPARISON RESULT - CT");
                 END IF;

            END IF;

            IF NOT (B > A) THEN
                 FAILED("THE RESULT OF THE COMPARISON IS INCORRECT");
            END IF;

      END;  --(D)

      DECLARE
              A : F := 0.0;
              B : F := 0.0;

      BEGIN COMMENT("CHECK NON-MODEL NUMBERS WITH DISTINCT" &
                "MODEL INTERVAL GIVES CORRECT RESULT IN COMPARISON " &
                "FOR FLOATING POINT");

            IF EQUAL (2,2) THEN
                 A := 16#0.A00000000000179A7#;
                 B := 16#0.A00000000000179C1#;

                 IF NOT (B > A) THEN
                      FAILED("INCORRECT COMPARISON RESULT - CT");
                 END IF;

            END IF;

            IF NOT (B > A) THEN
                 FAILED("THE RESULT OF THE COMPARISON IS INCORRECT");
            END IF;

      END;  --(E)

      DECLARE
              A : F := 0.0;
              B : F := 0.0;


      BEGIN COMMENT("CHECK TWO NON-MODEL NUMBERS WITH ONE" &
                "COMMON MODEL INTERVAL END-POINT IN A COMPARISON  " &
                "GIVES THE CORRECT RESULT");

            IF EQUAL (2,2) THEN
                 A := 16#0.A00000000000179BE#;
   -- MODEL NUMBER IS 16#0.A00000000000179D#
                 B := 16#0.A00000000000179C2#;

                 IF B < A THEN
                      FAILED("INCORRECT COMPARISON RESULT - CT");
                 END IF;

            END IF;

            IF B < A THEN
                 FAILED("THE RESULT OF THE COMPARISON IS INCORRECT");
            END IF;

      END;  --(F)

      RESULT;

END C45241O;
